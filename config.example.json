[
  {
    "name": "Build Notification",
    "match": {
      "$.source": ["aws.codebuild"],
      "$.detail-type": ["CodeBuild Build State Change"]
    },
    "variables": {
      "project": "$.detail.project-name",
      "status": "$.detail.build-status",
      "aws-region": "$.region",
      "log-stream-name": "$.detail.additional-information.logs.stream-name",
      "color": {
        "#abc8b6": {
          "match": {
            "$.detail.build-status": ["IN_PROGRESS", "SUCCEEDED"]
          }
        },
        "#e8674a": {
          "match": {
            "$.detail.build-status": ["FAILED"]
          }
        },
        "#f2cd90": {
          "match": {
            "$.detail.build-status": ["STOPPED"]
          }
        }
      }
    },
    "slackMessage": {
      "webhook": "https://hooks.slack.com/services/xyz/xyz/xyz",
      "channel": "builds",
      "username": "notification bot",
      "icon_url": "https://png.icons8.com/ultraviolet/540/bot.png",
      "attachments": [{
        "fallback": "Build <status> for project: <project>.",
        "pretext": "Build <status> for project: <project>.",
        "color": "<color>",
        "fields": [
          {
            "title": "Build run",
            "value": "<https://<aws-region>.console.aws.amazon.com/codebuild/home?region=<aws-region>#/builds/<project>/<log-stream-name>/view/new|<project>:<log-stream-name>>"
          }
        ]
      }]
    }
  }
]
